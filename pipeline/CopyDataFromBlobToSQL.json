{
	"name": "CopyDataFromBlobToSQL",
	"properties": {
		"activities": [
			{
				"name": "Copy_8v1",
				"type": "Copy",
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [
					{
						"name": "Source",
						"value": "tweets/@{formatDateTime(pipeline().parameters.windowStart,'yyyy')}/@{formatDateTime(pipeline().parameters.windowStart,'MM')}/27/@{formatDateTime(pipeline().parameters.windowStart,'HH')}/"
					},
					{
						"name": "Destination",
						"value": "[dbo].[tweets]"
					}
				],
				"typeProperties": {
					"source": {
						"type": "BlobSource",
						"recursive": false
					},
					"sink": {
						"type": "SqlSink",
						"writeBatchSize": 10000,
						"preCopyScript": "TRUNCATE TABLE dbo.tweets"
					},
					"enableStaging": false,
					"enableSkipIncompatibleRow": true,
					"translator": {
						"type": "TabularTranslator",
						"columnMappings": {
							"user_id": "user_id",
							"status_id": "status_id",
							"created_at": "created_at",
							"screen_name": "screen_name",
							"text": "text",
							"source": "source",
							"display_text_width": "display_text_width",
							"reply_to_status_id": "reply_to_status_id",
							"reply_to_user_id": "reply_to_user_id",
							"reply_to_screen_name": "reply_to_screen_name",
							"is_quote": "is_quote",
							"is_retweet": "is_retweet",
							"favorite_count": "favorite_count",
							"retweet_count": "retweet_count",
							"hashtags": "hashtags",
							"symbols": "symbols",
							"urls_url": "urls_url",
							"urls_t.co": "urls_t_co",
							"urls_expanded_url": "urls_expanded_url",
							"media_url": "media_url",
							"media_t.co": "media_t_co",
							"media_expanded_url": "media_expanded_url",
							"media_type": "media_type",
							"ext_media_url": "ext_media_url",
							"ext_media_t.co": "ext_media_t_co",
							"ext_media_expanded_url": "ext_media_expanded_url",
							"ext_media_type": "ext_media_type",
							"mentions_user_id": "mentions_user_id",
							"mentions_screen_name": "mentions_screen_name",
							"lang": "lang",
							"quoted_status_id": "quoted_status_id",
							"quoted_text": "quoted_text",
							"quoted_created_at": "quoted_created_at",
							"quoted_source": "quoted_source",
							"quoted_favorite_count": "quoted_favorite_count",
							"quoted_retweet_count": "quoted_retweet_count",
							"quoted_user_id": "quoted_user_id",
							"quoted_screen_name": "quoted_screen_name",
							"quoted_name": "quoted_name",
							"quoted_followers_count": "quoted_followers_count",
							"quoted_friends_count": "quoted_friends_count",
							"quoted_statuses_count": "quoted_statuses_count",
							"quoted_location": "quoted_location",
							"quoted_description": "quoted_description",
							"quoted_verified": "quoted_verified",
							"retweet_status_id": "retweet_status_id",
							"retweet_text": "retweet_text",
							"retweet_created_at": "retweet_created_at",
							"retweet_source": "retweet_source",
							"retweet_favorite_count": "retweet_favorite_count",
							"retweet_retweet_count": "retweet_retweet_count",
							"retweet_user_id": "retweet_user_id",
							"retweet_screen_name": "retweet_screen_name",
							"retweet_name": "retweet_name",
							"retweet_followers_count": "retweet_followers_count",
							"retweet_friends_count": "retweet_friends_count",
							"retweet_statuses_count": "retweet_statuses_count",
							"retweet_location": "retweet_location",
							"retweet_description": "retweet_description",
							"retweet_verified": "retweet_verified",
							"place_url": "place_url",
							"place_name": "place_name",
							"place_full_name": "place_full_name",
							"place_type": "place_type",
							"country": "country",
							"country_code": "country_code",
							"geo_coords": "geo_coords",
							"coords_coords": "coords_coords",
							"bbox_coords": "bbox_coords",
							"status_url": "status_url",
							"name": "name",
							"location": "location",
							"description": "description",
							"url": "url",
							"protected": "protected",
							"followers_count": "followers_count",
							"friends_count": "friends_count",
							"listed_count": "listed_count",
							"statuses_count": "statuses_count",
							"favourites_count": "favourites_count",
							"account_created_at": "account_created_at",
							"verified": "verified",
							"profile_url": "profile_url",
							"profile_expanded_url": "profile_expanded_url",
							"account_lang": "account_lang",
							"profile_banner_url": "profile_banner_url",
							"profile_background_url": "profile_background_url",
							"profile_image_url": "profile_image_url"
						}
					}
				}
			},
			{
				"name": "CopyTweetToHistory",
				"type": "SqlServerStoredProcedure",
				"dependsOn": [
					{
						"activity": "Copy_8v1",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"typeProperties": {
					"storedProcedureName": "[dbo].[usp_process_new_tweets]"
				}
			}
		],
		"parameters": {
			"windowStart": {
				"type": "String"
			}
		}
	},
	"type": "Microsoft.DataFactory/factories/pipelines"
}